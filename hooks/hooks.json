{
  "hooks": [
    {
      "type": "Setup",
      "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/setup.sh",
      "timeout": 30000
    },
    {
      "type": "SessionStart",
      "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/session-start.sh",
      "timeout": 10000
    },
    {
      "type": "Stop",
      "hooks": [
        {
          "type": "prompt",
          "prompt": "Session ending. Follow the MemEvolve-inspired consolidation pipeline:\n\n## 1. ENCODE — Capture session knowledge\nReview what happened this session. For each noteworthy item, use store_memory:\n- Architectural decisions → type=semantic, scope=project, importance=0.8\n- Bug fixes and error resolutions → type=episodic, scope=project, importance=0.6\n- Discovered patterns/conventions → type=procedural, scope=project, importance=0.7\n- Tool usage insights → type=procedural, scope=project, importance=0.5\n- Cross-project learnings (not specific to this codebase) → scope=user, importance=0.6\nSkip trivial operations. Tag each memory with relevant keywords.\n\n## 2. UPDATE — Strengthen existing memories\nIf you used recall_memories during this session and the recalled knowledge was helpful, those memories were already strengthened by access. No action needed.\n\n## 3. MANAGE — Promote and consolidate\nUse reflect_and_consolidate with dry_run=false to:\n- Promote high-value session memories to project scope\n- Queue stale low-importance memories for archival\n- Detect potential duplicates\n\nKeep the total new memories under 10 — quality over quantity."
        }
      ],
      "timeout": 30000
    },
    {
      "type": "PreCompact",
      "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/pre-compact.sh",
      "timeout": 15000
    },
    {
      "type": "PostToolUse",
      "matcher": {
        "toolName": "Write|Edit"
      },
      "hooks": [
        {
          "type": "command",
          "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/post-file-change.sh \"$TOOL_NAME\" \"$TOOL_INPUT\"",
          "timeout": 5000
        }
      ]
    },
    {
      "type": "PostToolUse",
      "matcher": {
        "toolName": "Bash",
        "exitCode": "!0"
      },
      "hooks": [
        {
          "type": "command",
          "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/post-bash-error.sh \"$TOOL_INPUT\" \"$TOOL_OUTPUT\"",
          "timeout": 5000
        }
      ]
    },
    {
      "type": "SubagentStart",
      "hooks": [
        {
          "type": "prompt",
          "prompt": "A subagent is being started. If the surrealdb-memory MCP server is available, use recall_memories to find any relevant project memories that might help this subagent with its task. Inject key context silently — do not mention the memory system to the subagent."
        }
      ],
      "timeout": 5000
    },
    {
      "type": "TaskCompleted",
      "hooks": [
        {
          "type": "prompt",
          "prompt": "A subagent task has completed. Review the task results. If the subagent discovered anything noteworthy (new patterns, solutions, errors, decisions), store it as a memory using store_memory with scope=project and appropriate type. Only store genuinely useful knowledge."
        }
      ],
      "timeout": 10000
    },
    {
      "type": "PermissionRequest",
      "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/auto-approve-memory.sh",
      "timeout": 3000
    },
    {
      "type": "TeammateIdle",
      "hooks": [
        {
          "type": "prompt",
          "prompt": "A teammate agent is idle. If the memory consolidation queue has pending items (check via reflect_and_consolidate with dry_run=true), consider assigning memory maintenance work to the idle agent."
        }
      ],
      "timeout": 5000
    }
  ]
}
